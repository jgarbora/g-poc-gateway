package com.g.g.apigateway.helper;

import com.fasterxml.jackson.core.JsonProcessingException;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.*;

class JwtHelperTest {

    @Test
    void findSubject() throws JsonProcessingException {
        String token = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6Ik1rVXpOMFV5TVRrMU9URkJPVGRDT1VJMk9ERTNORGxETkVNelF6TXpOVGMzTURrM01qZENNZyJ9.eyJpc3MiOiJodHRwczovL2pnYXJib3JhLmV1LmF1dGgwLmNvbS8iLCJzdWIiOiJhdXRoMHw2MGZlZDA3NTQ1MGIwNzAwNmE3YjM5OGQiLCJhdWQiOlsiZ2VuZXZhLXBvYy1hcGkiLCJodHRwczovL2pnYXJib3JhLmV1LmF1dGgwLmNvbS91c2VyaW5mbyJdLCJpYXQiOjE2Mjc2NTI0NjYsImV4cCI6MTYyNzczODg2NiwiYXpwIjoibGpuS05CbEJiYmwyS0FaN3dqUElKcU1NTmw4WFJZaEwiLCJzY29wZSI6Im9wZW5pZCBwcm9maWxlIGVtYWlsIiwicGVybWlzc2lvbnMiOlsiY3JlYXRlOnVzZXIiXX0.tQiE6tOW8iXHBf_QXfwpFcizS__iqXRadprThMjuRLO6QvtULTbD3K6iXmWHPFL5JK4GrNak7ov5Kb-ZH9aKLatQh5Axdj4uf5m2Oi49-cdntKvhX7zyIDYdwJY7CSEBe0Q9eDT2tkZdLb0p5lJSuIoOM5YMJd42lhmnx--pePuK2RlHQ1wbpMxWZm2lcdKZmUPmTAVHQ5dEmtqSJzd3jZvuXDoysu1f0mGOq0lKPmhWq0smWFs4yZC07VodE65qD__hbrT6YKmoEd6mdH_NBZf6AVTIJEBySTjX1onqLhsYZyPkiEQkDrgUaRm3kb1wBPM5rMVRqSHMbeUk__bV7g";
        Assertions.assertEquals("auth0|60fed075450b07006a7b398d", JwtHelper.findSubject(token));
    }

    @Test
    void findSubjectWithBearer() throws JsonProcessingException {
        String token = " Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6Ik1rVXpOMFV5TVRrMU9URkJPVGRDT1VJMk9ERTNORGxETkVNelF6TXpOVGMzTURrM01qZENNZyJ9.eyJpc3MiOiJodHRwczovL2pnYXJib3JhLmV1LmF1dGgwLmNvbS8iLCJzdWIiOiJ1VUV1MHNXUWhXczFrWjRDTFpYS3VjM1A4Zjk3b2k0Z0BjbGllbnRzIiwiYXVkIjoiZ2VuZXZhLXBvYy1hcGkiLCJpYXQiOjE2Mjc2NTY0MDgsImV4cCI6MTYyNzc0MjgwOCwiYXpwIjoidVVFdTBzV1FoV3Mxa1o0Q0xaWEt1YzNQOGY5N29pNGciLCJndHkiOiJjbGllbnQtY3JlZGVudGlhbHMiLCJwZXJtaXNzaW9ucyI6W119.mRc98DC5-WA72aWqeDLslejrKv77WehaRs5_PNlC_G2aShfKq3YVT8dJ0797CoPyxLLFJELV56i8VouC0tsf-mbVli_8IGFh9Uzs0F9zm4ohmjpqfVcq1FZ5wY7Q0kwc6jZKm1qbyH2WtxDNKqTF8zN5OjLnPUPUrUiWYoY1dS_b0fZZ50bMHYkdT3JIQSAfrzJB9B8n_tapZs0wUC--C8ogKRXoWvfAkYwTuoyuuKhKE6dT-IfSwXCoHDr4vp3PPUNuLPpWwhpZt4DilnX1XdbdEdzOvJzVSd8JuFTzc5ZUo554Zrnq-MdY4bJH4bu5Cwr2byCulnSUq0S46K2PIw";
        Assertions.assertEquals("auth0|60fed075450b07006a7b398d", JwtHelper.findSubject(token));
    }

    @Test
    void getPayload() throws JsonProcessingException {
        String token = " Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6Ik1rVXpOMFV5TVRrMU9URkJPVGRDT1VJMk9ERTNORGxETkVNelF6TXpOVGMzTURrM01qZENNZyJ9.eyJpc3MiOiJodHRwczovL2pnYXJib3JhLmV1LmF1dGgwLmNvbS8iLCJzdWIiOiJ1VUV1MHNXUWhXczFrWjRDTFpYS3VjM1A4Zjk3b2k0Z0BjbGllbnRzIiwiYXVkIjoiZ2VuZXZhLXBvYy1hcGkiLCJpYXQiOjE2Mjc2NTY0MDgsImV4cCI6MTYyNzc0MjgwOCwiYXpwIjoidVVFdTBzV1FoV3Mxa1o0Q0xaWEt1YzNQOGY5N29pNGciLCJndHkiOiJjbGllbnQtY3JlZGVudGlhbHMiLCJwZXJtaXNzaW9ucyI6W119.mRc98DC5-WA72aWqeDLslejrKv77WehaRs5_PNlC_G2aShfKq3YVT8dJ0797CoPyxLLFJELV56i8VouC0tsf-mbVli_8IGFh9Uzs0F9zm4ohmjpqfVcq1FZ5wY7Q0kwc6jZKm1qbyH2WtxDNKqTF8zN5OjLnPUPUrUiWYoY1dS_b0fZZ50bMHYkdT3JIQSAfrzJB9B8n_tapZs0wUC--C8ogKRXoWvfAkYwTuoyuuKhKE6dT-IfSwXCoHDr4vp3PPUNuLPpWwhpZt4DilnX1XdbdEdzOvJzVSd8JuFTzc5ZUo554Zrnq-MdY4bJH4bu5Cwr2byCulnSUq0S46K2PIw";
        System.out.println(JwtHelper.getPayload(token).toString());
    }

}